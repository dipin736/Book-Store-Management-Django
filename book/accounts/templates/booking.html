{% extends 'user_home.html' %}

{% load static %}
{%load crispy_forms_tags %} 


{% block main %}
 
<div class="container">
    <div class="row m-3">
        <div class="col-md-8 bg">
            <form action="" method="post" class="card p-3"  style="width: 100%;">
            <h3>Basic Details</h3>

                {% csrf_token %}
                <div class="m-3">
                    {{ form|crispy }}
                </div>
            </form>
        </div>
        <div class="col-md-4">
            <h2 class=" bg-light text-center">CHECKOUT</h2>
                <table class="table bg-light" >
                    <!-- <tr>
                        <td>ITEM TOTAL</td>
                        <td id="item_total"></td>
                    </tr> -->
                    <tr>
                        <td>ITEMS:</td>
                        <td id="items"></td>
                    </tr>                
                    <tr>
                        <td>DELIVERY</td>
                        <td>FREE</td>
                    </tr>
                    
                    <tr>
                        <td>GRAND TOTAL</td>
                        <td id="grand_total"></td>
                    </tr>
                </table>
            <button type="submit" class="btn btn-block btn-warning">
                <form action="success" method="POST">
                    <script
                        src="https://checkout.razorpay.com/v1/checkout.js"
                        data-key="rzp_test_tIYSGqIfPmDOgX" // Enter the Test API Key ID generated from Dashboard → Settings → API Keys
                        data-amount={{data.price}} // Amount is in currency subunits. Hence, 29935 refers to 29935 paise or ₹299.35.
                        data-currency="INR"// You can accept international payments by changing the currency code. Contact our Support Team to enable International for your account
                        data-order_id="order_CgmcjRh9ti2lP7"// Replace with the order_id generated by you in the backend.
                        data-buttontext="Pay with Razorpay"
                        data-name="Acme Corp"
                        data-description="A Wild Sheep Chase is the third novel by Japanese author Haruki Murakami"
                        data-image="https://example.com/your_logo.jpg"
                        data-prefill.name="{{ request.user.first_name }} {{ request.user.last_name }}"
                        data-prefill.email="{{ request.user.email }}"
                        data-theme.color="#F37254"
                    ></script>
                    <input type="hidden" custom="Hidden Element" name="hidden"/>
                    </form>
            </button>

            </div>

    </div>
  
    
    <script>
          function grandTotal(){
               $.ajax({
                   url:"{% url 'get_cart_data' %}",
                   type:'get',
                   success:function(data){
                    //    $("#item_total").html(data.price)
                        $("#items").html(data.items);
                        $("#grand_total").html(data.price)
                   }
               })
           }
           grandTotal(); 
    </script>
  
 
{% endblock main %}
    
